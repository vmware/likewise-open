LIKEWISE_OPEN_MAJOR=5
LIKEWISE_OPEN_MINOR=2
LIKEWISE_OPEN_BUILD=0
LIKEWISE_OPEN_REVISION=33168

get_lwopen_version() {
	VERSION=${LIKEWISE_OPEN_MAJOR}.${LIKEWISE_OPEN_MINOR}.${LIKEWISE_OPEN_BUILD}.${LIKEWISE_OPEN_REVISION}

	echo "${VERSION}"
}

create_rpmbuild_directory() {
	topdir=`rpm --eval %_topdir`
	mkdir -p ${topdir}/{SOURCES,SPECS,BUILD,RPMS,SRPMS}
}

build_dist() {
	BASEDIR=`dirname $0`/../..
	RELEASE=""

	. ${BASEDIR}/packaging/scripts/functions
	VERSION=$(get_lwopen_version)

	TARGET=likewise-open-$VERSION$RELEASE
	/bin/rm -rf $BASEDIR/../$TARGET || exit 1
	mkdir $BASEDIR/../$TARGET || exit 1
	for dir in centutils domainjoin winbindd; do
	        rsync -a --exclude=.git* --exclude=.svn --exclude=*~ --exclude=*bak \
	                $BASEDIR/$dir $BASEDIR/../$TARGET/ || exit 1
	done
	cd $BASEDIR/..
	tar cf - $TARGET | gzip -9 > likewise-open-$VERSION.tar.gz
}
